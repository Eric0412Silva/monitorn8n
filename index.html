<!DOCTYPE html>
<html lang="pt-br" class="h-full antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio Interativo | Monitor de Status n8n</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Tailwind Default (Gray, White, Blue/Indigo) -->
    <!-- Application Structure Plan: SPA Responsiva com Menu Off-Canvas para Mobile e Sidebar Fixa para Desktop. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        html {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }
        
        /* --- Estilos do Diagrama de Fluxo --- */
        .workflow-arrow {
            position: relative;
            height: 30px;
            width: 2px;
            background-color: #9ca3af; /* gray-400 */
            margin-left: auto;
            margin-right: auto;
        }
        .workflow-arrow::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: -4px;
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid #9ca3af;
        }
        
        /* N√≥ Diamante (Decis√£o) */
        .workflow-node.diamond {
            width: 140px; /* Levemente menor para mobile */
            height: 80px;
            transform: rotate(45deg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
        }
        @media (min-width: 768px) {
            .workflow-node.diamond {
                width: 180px;
                height: 100px;
            }
        }
        .workflow-node.diamond span {
            transform: rotate(-45deg);
            max-width: 120px;
            text-align: center;
            font-size: 0.9rem;
            line-height: 1.1;
        }

        /* Linhas de Ramifica√ß√£o (Branches) */
        .if-branch {
            position: relative;
            width: 100%;
        }
        .if-branch::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            width: 50%;
            height: 2px;
            background-color: #9ca3af;
        }
        .if-branch.true-branch::before { left: 50%; }
        .if-branch.false-branch::before { right: 50%; width: 50%; left: 0; }
        
        .if-branch .workflow-arrow {
            position: absolute;
            top: -15px;
        }
        .if-branch.true-branch .workflow-arrow { right: 0; left: auto; }
        .if-branch.false-branch .workflow-arrow { left: 0; right: auto; }

        /* Scrollbar sutil */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        .nav-link.active {
            background-color: #eef2ff;
            color: #4f46e5;
            font-weight: 600;
            border-right: 3px solid #4f46e5;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 h-full">

    <div class="flex h-full flex-col md:flex-row">
        
        <!-- Header Mobile (Fixo no topo) -->
        <header class="md:hidden sticky top-0 bg-white shadow-sm z-30 w-full flex items-center justify-between p-4 border-b border-gray-200">
            <div class="flex items-center">
                <span class="bg-indigo-600 text-white p-1.5 rounded-md mr-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                </span>
                <h2 class="text-lg font-bold text-indigo-900">Monitor n8n</h2>
            </div>
            <button id="menu-btn" class="p-2 rounded-md text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
            </button>
        </header>

        <!-- Overlay do Menu Mobile -->
        <div id="mobile-menu-overlay" class="fixed inset-0 bg-gray-900/50 z-40 hidden transition-opacity duration-300 md:hidden backdrop-blur-sm"></div>

        <!-- Sidebar de Navega√ß√£o (Desktop Fixa / Mobile Off-canvas) -->
        <aside id="sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 transform -translate-x-full transition-transform duration-300 ease-in-out md:translate-x-0 md:static md:h-screen md:flex-shrink-0 overflow-y-auto">
            <div class="p-6 hidden md:flex items-center border-b border-gray-100">
                <span class="bg-indigo-600 text-white p-1.5 rounded-md mr-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                </span>
                <div>
                    <h2 class="text-xl font-bold text-indigo-900">Monitor n8n</h2>
                    <p class="text-xs text-gray-500 font-medium">Doc. T√©cnica v1.0</p>
                </div>
            </div>
            
            <!-- T√≠tulo Mobile dentro do menu -->
            <div class="p-4 md:hidden flex justify-between items-center border-b border-gray-100 bg-gray-50">
                <span class="font-semibold text-gray-700">Menu</span>
                <button id="close-menu-btn" class="text-gray-500">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>

            <nav class="p-4 space-y-1">
                <a href="#overview" class="nav-link group flex items-center px-3 py-2.5 text-sm font-medium text-gray-600 rounded-r-md hover:bg-indigo-50 hover:text-indigo-600 transition-colors">
                    Vis√£o Geral
                </a>
                <a href="#requirement" class="nav-link group flex items-center px-3 py-2.5 text-sm font-medium text-gray-600 rounded-r-md hover:bg-indigo-50 hover:text-indigo-600 transition-colors">
                    Requisito Funcional
                </a>
                <a href="#architecture" class="nav-link group flex items-center px-3 py-2.5 text-sm font-medium text-gray-600 rounded-r-md hover:bg-indigo-50 hover:text-indigo-600 transition-colors">
                    Arquitetura do Fluxo
                </a>
                <a href="#services" class="nav-link group flex items-center px-3 py-2.5 text-sm font-medium text-gray-600 rounded-r-md hover:bg-indigo-50 hover:text-indigo-600 transition-colors">
                    Servi√ßos Monitorados
                </a>
                <a href="#logic" class="nav-link group flex items-center px-3 py-2.5 text-sm font-medium text-gray-600 rounded-r-md hover:bg-indigo-50 hover:text-indigo-600 transition-colors">
                    L√≥gica Principal (JS)
                </a>
                <a href="#sustainment" class="nav-link group flex items-center px-3 py-2.5 text-sm font-medium text-gray-600 rounded-r-md hover:bg-indigo-50 hover:text-indigo-600 transition-colors">
                    Testes e Sustenta√ß√£o
                </a>
            </nav>
        </aside>

        <!-- √Årea de Conte√∫do Principal -->
        <main class="flex-1 h-[calc(100vh-64px)] md:h-screen overflow-y-auto scroll-smooth">
            <div class="max-w-5xl mx-auto p-4 md:p-10 space-y-16 pb-20">
                
                <!-- 1. Vis√£o Geral -->
                <section id="overview" class="scroll-mt-24 md:scroll-mt-10">
                    <div class="space-y-4">
                        <span class="inline-block px-3 py-1 text-xs font-semibold text-indigo-600 bg-indigo-100 rounded-full uppercase tracking-wide">Documenta√ß√£o T√©cnica</span>
                        <h1 class="text-3xl md:text-4xl font-extrabold text-gray-900 leading-tight">Automa√ß√£o de Monitoramento de Status Pages</h1>
                        <p class="text-lg text-gray-600 leading-relaxed">
                            Esta documenta√ß√£o detalha a automa√ß√£o implementada no <strong>n8n</strong> para monitoramento ativo de provedores de servi√ßo externos (SaaS/PaaS). O rob√¥ consulta endpoints JSON p√∫blicos e notifica grupos do Telegram sobre a sa√∫de dos servi√ßos.
                        </p>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 pt-4">
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div class="text-xs font-bold text-gray-400 uppercase mb-1">Sistemas</div>
                                <div class="font-semibold text-indigo-700">n8n, Telegram API</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div class="text-xs font-bold text-gray-400 uppercase mb-1">P√∫blico-Alvo</div>
                                <div class="font-semibold text-gray-800">DevOps, Sustenta√ß√£o</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <div class="text-xs font-bold text-gray-400 uppercase mb-1">Tipo</div>
                                <div class="font-semibold text-green-600">Nova Funcionalidade</div>
                            </div>
                        </div>
                    </div>
                </section>

                <hr class="border-gray-200">

                <!-- 2. Requisito Funcional -->
                <section id="requirement" class="scroll-mt-24 md:scroll-mt-10">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">Requisito Funcional</h2>
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                        <div class="p-6 md:p-8 space-y-6">
                            <div>
                                <h3 class="flex items-center text-lg font-semibold text-gray-800 mb-2">
                                    <span class="w-8 h-8 rounded-full bg-orange-100 text-orange-600 flex items-center justify-center mr-3 text-sm">1</span>
                                    Cen√°rio
                                </h3>
                                <p class="text-gray-600 ml-11">A equipe de TI necessitava de visibilidade imediata sobre a indisponibilidade de fornecedores cr√≠ticos (Cloudflare, SAP, Atlassian, etc.) para agilizar a resposta a incidentes.</p>
                            </div>
                            <div>
                                <h3 class="flex items-center text-lg font-semibold text-gray-800 mb-2">
                                    <span class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-3 text-sm">2</span>
                                    Solu√ß√£o
                                </h3>
                                <p class="text-gray-600 ml-11">Fluxo automatizado no n8n que realiza a varredura a cada 15 minutos nas APIs de status p√∫blicas.</p>
                            </div>
                            <div>
                                <h3 class="flex items-center text-lg font-semibold text-gray-800 mb-2">
                                    <span class="w-8 h-8 rounded-full bg-green-100 text-green-600 flex items-center justify-center mr-3 text-sm">3</span>
                                    Comportamento
                                </h3>
                                <div class="ml-11 bg-gray-50 rounded-lg p-4 text-sm text-gray-700 border border-gray-100">
                                    <ul class="space-y-2">
                                        <li class="flex items-start">
                                            <svg class="w-4 h-4 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                            Coleta status de 6 servi√ßos simultaneamente.
                                        </li>
                                        <li class="flex items-start">
                                            <svg class="w-4 h-4 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                            Processa dados para identificar falhas (`status != operational`).
                                        </li>
                                        <li class="flex items-start">
                                            <svg class="w-4 h-4 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                            Envia relat√≥rio consolidado para o Telegram.
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <hr class="border-gray-200">

                <!-- 3. Arquitetura do Fluxo -->
                <section id="architecture" class="scroll-mt-24 md:scroll-mt-10">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">Arquitetura do Fluxo</h2>
                    <p class="text-gray-600 mb-6">Representa√ß√£o visual do workflow `Monitor_Status_Services_Telegram`. <span class="hidden md:inline">Clique nos n√≥s para ver detalhes.</span><span class="md:hidden text-indigo-600 font-medium">Toque nos n√≥s para detalhes.</span></p>
                    
                    <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-8 overflow-hidden">
                        <!-- Container com Scroll Horizontal para Mobile -->
                        <div class="overflow-x-auto pb-4 custom-scrollbar flex flex-col items-center min-w-[300px]">
                            
                            <!-- N√≥ Inicial -->
                            <div class="workflow-node bg-green-50 border border-green-200 hover:border-green-400 text-green-900 rounded-lg p-3 w-48 text-center shadow-sm cursor-pointer transition-all active:scale-95" data-node="trigger">
                                <div class="text-xs font-bold uppercase text-green-600 mb-1">Trigger</div>
                                <div class="font-semibold text-sm">A cada 15 min</div>
                            </div>
                            <div class="workflow-arrow"></div>

                            <!-- N√≥ 2 -->
                            <div class="workflow-node bg-white border border-gray-300 hover:border-indigo-400 text-gray-800 rounded-lg p-3 w-48 text-center shadow-sm cursor-pointer transition-all active:scale-95" data-node="lista">
                                <div class="text-xs font-bold uppercase text-gray-400 mb-1">Code</div>
                                <div class="font-semibold text-sm">Lista de Servi√ßos</div>
                            </div>
                            <div class="workflow-arrow"></div>

                            <!-- N√≥ 3 -->
                            <div class="workflow-node bg-white border border-gray-300 hover:border-indigo-400 text-gray-800 rounded-lg p-3 w-48 text-center shadow-sm cursor-pointer transition-all active:scale-95" data-node="http">
                                <div class="text-xs font-bold uppercase text-gray-400 mb-1">HTTP Request</div>
                                <div class="font-semibold text-sm">Checar Status</div>
                            </div>
                            <div class="workflow-arrow"></div>

                            <!-- N√≥ 4 -->
                            <div class="workflow-node bg-white border border-gray-300 hover:border-indigo-400 text-gray-800 rounded-lg p-3 w-48 text-center shadow-sm cursor-pointer transition-all active:scale-95" data-node="relatorio">
                                <div class="text-xs font-bold uppercase text-gray-400 mb-1">Code</div>
                                <div class="font-semibold text-sm">Gera Relat√≥rio</div>
                            </div>
                            <div class="workflow-arrow"></div>

                            <!-- N√≥ 5 (IF) -->
                            <div class="workflow-node diamond bg-yellow-50 border border-yellow-400 text-yellow-900 shadow-sm cursor-pointer transition-all active:scale-95" data-node="if">
                                <span class="font-bold text-sm">Teve Erro?</span>
                            </div>
                            
                            <!-- Branches do IF -->
                            <div class="flex w-full max-w-md mt-2">
                                <!-- Ramo Falso -->
                                <div class="w-1/2 px-1 text-center relative if-branch false-branch">
                                    <span class="text-xs font-bold text-gray-400 bg-white px-1 absolute -top-7 left-1/4 z-10">False</span>
                                    <div class="workflow-arrow" style="margin-top: -15px;"></div>
                                    <div class="workflow-node bg-green-50 border border-green-200 hover:border-green-400 text-green-900 rounded-lg p-3 shadow-sm cursor-pointer mt-4 transition-all active:scale-95" data-node="sucesso">
                                        <div class="text-xs font-bold uppercase text-green-600 mb-1">Telegram</div>
                                        <div class="font-semibold text-sm">Sucesso</div>
                                    </div>
                                </div>
                                <!-- Ramo Verdadeiro -->
                                <div class="w-1/2 px-1 text-center relative if-branch true-branch">
                                    <span class="text-xs font-bold text-red-400 bg-white px-1 absolute -top-7 right-1/4 z-10">True</span>
                                    <div class="workflow-arrow" style="margin-top: -15px;"></div>
                                    <div class="workflow-node bg-red-50 border border-red-200 hover:border-red-400 text-red-900 rounded-lg p-3 shadow-sm cursor-pointer mt-4 transition-all active:scale-95" data-node="alerta">
                                        <div class="text-xs font-bold uppercase text-red-600 mb-1">Telegram</div>
                                        <div class="font-semibold text-sm">Alerta</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <p class="text-center text-xs text-gray-400 mt-4 md:hidden">Arraste horizontalmente se necess√°rio</p>
                    </div>
                </section>

                <hr class="border-gray-200">

                <!-- 4. Servi√ßos Monitorados -->
                <section id="services" class="scroll-mt-24 md:scroll-mt-10">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">Servi√ßos Monitorados</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Card -->
                        <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-sm flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-bold">C</div>
                            <div class="min-w-0">
                                <h3 class="font-semibold text-gray-900">Cloudflare</h3>
                                <p class="text-xs text-gray-500 truncate">cloudflarestatus.com</p>
                            </div>
                        </div>
                        <!-- Card -->
                        <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-sm flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center text-orange-600 font-bold">I</div>
                            <div class="min-w-0">
                                <h3 class="font-semibold text-gray-900">Infobip</h3>
                                <p class="text-xs text-gray-500 truncate">status.infobip.com</p>
                            </div>
                        </div>
                        <!-- Card -->
                        <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-sm flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold">U</div>
                            <div class="min-w-0">
                                <h3 class="font-semibold text-gray-900">Unico</h3>
                                <p class="text-xs text-gray-500 truncate">status.unico.io</p>
                            </div>
                        </div>
                        <!-- Card -->
                        <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-sm flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 font-bold">S</div>
                            <div class="min-w-0">
                                <h3 class="font-semibold text-gray-900">Serasa</h3>
                                <p class="text-xs text-gray-500 truncate">status.allowme.com.br</p>
                            </div>
                        </div>
                        <!-- Card -->
                        <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-sm flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-cyan-100 flex items-center justify-center text-cyan-600 font-bold">S</div>
                            <div class="min-w-0">
                                <h3 class="font-semibold text-gray-900">SAP for Me</h3>
                                <p class="text-xs text-gray-500 truncate">status.me.sap.com</p>
                            </div>
                        </div>
                        <!-- Card -->
                        <div class="p-4 bg-white rounded-lg border border-gray-200 shadow-sm flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-800 font-bold">A</div>
                            <div class="min-w-0">
                                <h3 class="font-semibold text-gray-900">Atlassian</h3>
                                <p class="text-xs text-gray-500 truncate">status.atlassian.com</p>
                            </div>
                        </div>
                    </div>
                </section>

                <hr class="border-gray-200">

                <!-- 5. L√≥gica Principal -->
                <section id="logic" class="scroll-mt-24 md:scroll-mt-10">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">L√≥gica Principal (JS)</h2>
                    <p class="text-gray-600 mb-6">Script JavaScript (ES6) usado no n√≥ "Gera Relat√≥rio" para cruzar dados e formatar a mensagem.</p>
                    
                    <div class="bg-gray-900 text-white rounded-xl shadow-lg overflow-hidden">
                        <div class="flex justify-between items-center px-4 py-3 bg-gray-800 border-b border-gray-700">
                            <div class="flex items-center space-x-2">
                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            </div>
                            <button id="copy-btn" class="text-xs font-medium bg-gray-700 hover:bg-gray-600 text-gray-300 px-3 py-1.5 rounded transition-colors flex items-center">
                                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                                Copiar C√≥digo
                            </button>
                        </div>
                        <div class="p-4 overflow-x-auto">
<pre><code id="code-block" class="language-javascript text-sm font-mono leading-relaxed text-gray-300">
// 1. Recupera a lista original (nomes definidos manualmente)
const originals = $('Lista de Servi√ßos').all();
// 2. Recupera os resultados das requisi√ß√µes HTTP
const responses = $input.all();

let messageLines = [];
let hasError = false;

// 3. Itera cruzando os dados pelo √≠ndice
originals.forEach((original, index) => {
  const name = original.json.name;
  
  // Fallback seguro: se a resposta n√£o existir, cria objeto vazio
  const responseJson = responses[index] ? responses[index].json : {};
  
  let indicator = 'unknown';
  let description = 'Erro de Conex√£o/Timeout';

  // Valida√ß√£o da estrutura da resposta da API (Padr√£o Atlassian)
  if (responseJson.status) {
    indicator = responseJson.status.indicator;
    description = responseJson.status.description;
  }

  // Classifica√ß√£o de Status
  if (indicator === 'none' || indicator === 'operational') {
    messageLines.push(`üü¢ *${name}:* Operacional`);
  } else if (indicator === 'unknown') {
    hasError = true; 
    messageLines.push(`‚ö™ *${name}:* Falha na Leitura`);
  } else {
    hasError = true;
    messageLines.push(`üî¥ *${name}:* INST√ÅVEL (${description})`);
  }
});

// 4. Montagem do Relat√≥rio Final
let finalMessage = "üìã *Relat√≥rio de Status*\\n\\n";
finalMessage += messageLines.join('\\n');

if (hasError) {
  finalMessage += "\\n\\n‚ö†Ô∏è *Aten√ß√£o:* Instabilidades detectadas.";
} else {
  finalMessage += "\\n\\n‚úÖ Todos os sistemas monitorados est√£o est√°veis.";
}

return [
  {
    json: {
      has_error: hasError,
      message: finalMessage
    }
  }
];
</code></pre>
                        </div>
                    </div>
                </section>
                
                <hr class="border-gray-200">

                <!-- 6. Sustenta√ß√£o -->
                <section id="sustainment" class="scroll-mt-24 md:scroll-mt-10">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">Sustenta√ß√£o</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-green-50 p-6 rounded-xl border border-green-100">
                            <h3 class="font-bold text-green-800 mb-4 flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                Checklist de Valida√ß√£o
                            </h3>
                            <ul class="space-y-3 text-sm text-green-800">
                                <li>‚úì Monitoramento dos 6 servi√ßos ativo.</li>
                                <li>‚úì Alertas de sucesso apenas com 100% de uptime.</li>
                                <li>‚úì Resili√™ncia a falhas de API (404/500) testada.</li>
                            </ul>
                        </div>
                        <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100">
                            <h3 class="font-bold text-indigo-800 mb-4 flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                                Manuten√ß√£o
                            </h3>
                            <p class="text-sm text-indigo-800 mb-2">Para adicionar um servi√ßo:</p>
                            <code class="block bg-white px-2 py-1 rounded text-xs border border-indigo-200 text-indigo-600 font-mono">{ json: { name: "Novo", url: "..." } }</code>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Modal -->
    <div id="modal-overlay" class="fixed inset-0 bg-black/60 z-[60] hidden transition-opacity duration-300 backdrop-blur-sm"></div>
    <div id="modal" class="fixed inset-0 z-[70] flex items-end md:items-center justify-center p-0 md:p-4 hidden">
        <div id="modal-content" class="bg-white w-full md:max-w-lg rounded-t-2xl md:rounded-2xl shadow-2xl overflow-hidden transform transition-all duration-300 translate-y-full md:translate-y-0 md:scale-95 md:opacity-0">
            <div class="flex justify-between items-center p-4 border-b border-gray-100 bg-gray-50">
                <h3 id="modal-title" class="text-lg font-bold text-gray-900"></h3>
                <button id="modal-close" class="p-1 rounded-full hover:bg-gray-200 transition-colors">
                    <svg class="w-6 h-6 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <div id="modal-body" class="p-6 text-gray-600 space-y-4 max-h-[70vh] overflow-y-auto">
                <!-- Conte√∫do -->
            </div>
            <div class="p-4 border-t border-gray-100 bg-gray-50 md:hidden">
                <button id="modal-close-btn-bottom" class="w-full bg-gray-200 text-gray-800 font-semibold py-3 rounded-lg">Fechar</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const menuBtn = document.getElementById('menu-btn');
            const closeMenuBtn = document.getElementById('close-menu-btn');
            const sidebar = document.getElementById('sidebar');
            const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
            const navLinks = document.querySelectorAll('.nav-link');

            function openMenu() {
                sidebar.classList.remove('-translate-x-full');
                mobileMenuOverlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Evita scroll no body
            }

            function closeMenu() {
                sidebar.classList.add('-translate-x-full');
                mobileMenuOverlay.classList.add('hidden');
                document.body.style.overflow = '';
            }

            menuBtn.addEventListener('click', openMenu);
            closeMenuBtn.addEventListener('click', closeMenu);
            mobileMenuOverlay.addEventListener('click', closeMenu);

            navLinks.forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth < 768) { // S√≥ fecha no mobile
                        closeMenu();
                    }
                });
            });

            // --- Modal Logic ---
            const modal = document.getElementById('modal');
            const modalOverlay = document.getElementById('modal-overlay');
            const modalContent = document.getElementById('modal-content');
            const modalCloseBtn = document.getElementById('modal-close');
            const modalCloseBtnBottom = document.getElementById('modal-close-btn-bottom');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');

            const nodeData = {
                trigger: { title: "N√≥: A cada 15 min", details: "<p>Gatilho agendado (Schedule Trigger).</p><p class='mt-2'>Garante que o monitoramento rode periodicamente sem interven√ß√£o.</p>" },
                lista: { title: "N√≥: Lista de Servi√ßos", details: "<p>Define a lista de servi√ßos JSON.</p><p class='mt-2 text-sm'>Para adicionar um servi√ßo, edite o Array JSON neste n√≥.</p>" },
                http: { title: "N√≥: Checar Status", details: "<p>Faz requisi√ß√µes GET para as APIs.</p><p class='mt-2 text-sm bg-yellow-50 p-2 rounded text-yellow-800 border border-yellow-200'><strong>Importante:</strong> A op√ß√£o 'On Error: Continue' deve estar ativa para n√£o travar o fluxo.</p>" },
                relatorio: { title: "N√≥: Gera Relat√≥rio", details: "<p>Script JS que cruza os dados.</p><p class='mt-2'>Transforma c√≥digos de status (none, major, critical) em emojis visuais.</p>" },
                if: { title: "N√≥: Teve Erro?", details: "<p>Condicional simples.</p><p class='mt-2'>Se <code>has_error == true</code>, vai para Alerta. Se n√£o, Sucesso.</p>" },
                alerta: { title: "N√≥: Telegram Alerta", details: "<p>Envia mensagem formatada com falhas.</p>" },
                sucesso: { title: "N√≥: Telegram Sucesso", details: "<p>Envia mensagem de 'Tudo OK'.</p>" }
            };

            function openModal(title, content) {
                modalTitle.textContent = title;
                modalBody.innerHTML = content;
                modal.classList.remove('hidden');
                modalOverlay.classList.remove('hidden');
                // Anima√ß√£o de entrada
                setTimeout(() => {
                    modalContent.classList.remove('translate-y-full', 'md:scale-95', 'md:opacity-0');
                    modalContent.classList.add('translate-y-0', 'md:scale-100', 'md:opacity-100');
                }, 10);
            }

            function closeModal() {
                modalContent.classList.remove('translate-y-0', 'md:scale-100', 'md:opacity-100');
                modalContent.classList.add('translate-y-full', 'md:scale-95', 'md:opacity-0');
                setTimeout(() => {
                    modal.classList.add('hidden');
                    modalOverlay.classList.add('hidden');
                }, 300);
            }

            [modalCloseBtn, modalCloseBtnBottom, modalOverlay].forEach(el => {
                if(el) el.addEventListener('click', closeModal);
            });

            document.querySelectorAll('.workflow-node').forEach(node => {
                const nodeKey = node.getAttribute('data-node');
                if (nodeData[nodeKey]) {
                    node.addEventListener('click', () => {
                        openModal(nodeData[nodeKey].title, nodeData[nodeKey].details);
                    });
                }
            });

            // --- Copy Logic ---
            const copyBtn = document.getElementById('copy-btn');
            const codeBlock = document.getElementById('code-block');

            copyBtn.addEventListener('click', () => {
                const textToCopy = codeBlock.innerText;
                const textarea = document.createElement('textarea');
                textarea.value = textToCopy;
                textarea.style.position = 'fixed';
                textarea.style.left = '-9999px';
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    const originalText = copyBtn.innerHTML;
                    copyBtn.innerHTML = `<svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> Copiado!`;
                    copyBtn.classList.replace('bg-gray-700', 'bg-green-600');
                    setTimeout(() => {
                        copyBtn.innerHTML = originalText;
                        copyBtn.classList.replace('bg-green-600', 'bg-gray-700');
                    }, 2000);
                } catch (err) {
                    console.error('Erro ao copiar', err);
                }
                document.body.removeChild(textarea);
            });
        });
    </script>
</body>
</html>
